<!-- Code to render a bar chart showing the number of tickets per category -->
<!-- Expects a local variable `category_counts` which is a hash with category names as keys and ticket counts as values -->
<% counts = local_assigns[:category_counts] || @category_counts || {} %>

<div id="category-chart-container">
  <canvas id="categoryChart"></canvas>
</div>

<!-- Script to initialize Chart.js bar chart and update it dynamically with category counts -->
<script>
  const ctx = document.getElementById('categoryChart');

  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: <%= raw counts.keys.to_json %>,
      datasets: [{
        label: 'Tickets per Issue/Category',
        data: <%= raw counts.values.to_json %>,
        backgroundColor: ['#f37c20', '#007bff', '#28a745', '#6c757d']
      }]
    },
    options: {
      responsive: true,
      scales: {
        y: { beginAtZero: true }
      }
    }
  });
</script>
